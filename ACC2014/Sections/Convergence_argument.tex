\section{Convergence}

Let $M$ be a volume manifold of dimension $d$ and for each $X \in \mathfrak{X}(M)$ consider the partial differential operator $D_X$ where $(D_X [f] )(x) = \pounds_X[f] (x)+ \frac{1}{2} \mathrm{div}(X)(x) \cdot f(x) = \sum_{\abs{m}\leq 1} a_m(x) \partial^m f(x)$ with (local) coefficients $a_m \in C^{\infty}(M)$. Assume that $(\psi_\lambda)_{\lambda \in \Lambda}$ and $(\tilde{\psi}_\lambda)_{\lambda \in \Lambda}$ are a pair of wavelet bases. We denote by $P_j$ the projection onto the scaling functions associated with $\psi$ of resolution $2^{-j}$. We also let $\card{\lambda}$ denote the resolution level of the index $\lambda$. 

Define weighted spaces as:
\begin{equation}
	\ell_t^2(\Lambda) = \left\{ (c_\lambda)_{\lambda \in \Lambda}  \mid \norm{(c_\lambda)}_{l^2_t}^2 = \sum_{\lambda \in \Lambda} 2^{2t\card{\lambda}}\abs{c_\lambda}^2 < \infty  \right\}.
\end{equation}
When $t = 0$ we write $\ell^2$ for the aforementioned weighted space. We are interested in evaluating the entries:
\begin{equation}
	[X]_{\lambda,\mu} = \langle D_X \psi_\lambda, \tilde{\psi}_\mu \rangle.
\end{equation}
We let $[X]=([X]_{\lambda,\mu})_{\lambda,\mu \in \Lambda}$. Assume further that there exists an $\alpha,n \in \N$ such that the wavelets are in $C^{\alpha}$, $\alpha \geq \frac{d}{2} + 1$, and that the wavelets are orthogonal to polynomials of degree $n \geq \alpha - 1$.  Note by Theorem 3.6.1 in \cite{Cohen2003} the norm equivalence between elements in $W^{t,2}$ and the $l_t^2$ norm of the wavelet decomposition of that same element using either wavelet bases for $0\leq t \leq \alpha$. For the sake of convenience, we let $s = \frac{d}{2} + 1$. 

\begin{lemma} \label{lem:projection_bound}
	Let $f \in W^{s,2}(M)$ and $j \geq \frac{d}{2}$ and $P_j$ denote the $L^2$-orthogonal projection onto polynomials of degree $j$.
	Then $\norm{f - P_j f}_{L^2} \leq  2^{-sj}\norm{f}_{W^{s,2}}$,
\end{lemma}
\begin{proof}
	This follows from either Theorem 3.3.2 or 3.10.2 in \cite{Cohen2003}.
\end{proof}

\begin{lemma} \label{lem:matrix_bound}
	$\abs{[X]_{\lambda,\mu}} \leq C 2^{-(\frac{d}{2}+\frac{1}{2})\abs{\abs{\lambda}-\abs{\mu}}}2^{\frac{1}{2}(\abs{\lambda}+\abs{\mu})}$
\end{lemma}
\begin{proof}
	\begin{align*}
		\abs{[X]_{\lambda,\mu}} 	&= \int \abs{X \psi_{\lambda}(x) \tilde{\psi}_{\mu}(x)} dx \\
								&\leq \norm{\tilde{\psi}_\mu}_{L^1} \| X \psi_\lambda \|_{L^\infty}, \\ %\inf_{g \in \Pi_n} \norm{X \psi_{\lambda} - g}_{L^{\infty}} \\
							\intertext{by Theorem 3.3.1 and 3.10.2 of \cite{Cohen2003} we observe: }
								&\leq C_1 2^{-\card{\mu}\frac{d}{2}}\norm{X\psi_{\lambda}}_{L^{\infty}} \\
								&= C_1 2^{-\card{\mu}\frac{d}{2}}\norm{ \sum_{\abs{m} \leq 1 } a_m(x) \psi^{(m)}_\lambda(x) }_{L^{\infty}} \\
								&\leq C_2 2^{-\card{\mu}\frac{d}{2}}\sum_{\card{m}\leq 1}\norm{\psi_{\lambda}^{(m)}(x)}_{L^{\infty}} , \\
							\intertext{and by the definition of wavelets:}
								&\leq C_3 2^{-\card{\mu}\frac{d}{2}} 2^{\card{\lambda}\frac{d}{2}} \sum_{\card{m}\leq 1} (2^{\card{\lambda}})^{\abs{m}} \\
								&\leq C_3 (d+1) 2^{-\card{\mu}\frac{d}{2}} 2^{\card{\lambda}(1+\frac{d}{2})} \\
								&= C_4 2^{d/2(\card{\lambda} - \card{\mu})}2^{\card{\lambda}},
	\end{align*}
	%where the second line follows from the fact that $\tilde{\psi}$ is orthogonal to polynomials of degree $n$, 
	%the third line follows from Theorems 3.3.1 and 3.10.2 in \cite{Cohen2003},
	%the fourth line follows from the definition of $X$, and the fifth follows from the definition of the wavelets.
	The desired result follows from a symmetry argument and a rearrangement.
\end{proof}

\begin{lemma} \label{lem:M_bound}
	$[X]$ is a bounded linear operator from $W^{s,2}(M)$ to $L^2(M)$.
\end{lemma}
\begin{proof}
	Consider $f \in W^{s,2}(M)$ with wavelet expansion $(f_\lambda)_{\lambda \in \Lambda}$ such that $\norm{(f_\lambda)}_{l_s^2} = 1$, then:
	\begin{align*}
		\norm{[X] f}_{l^2}^2   &=    \sum_{\mu \in \Lambda} \abs{ \sum_{\lambda \in \Lambda} [X]_{\mu,\lambda} f_{\lambda} }^2. \\
		\intertext{ Upon invoking Lemma \ref{lem:matrix_bound} we find,}
							&\leq C\sum_{\mu \in \Lambda} \sum_{\lambda \in \Lambda} 2^{-(d+1)\abs{\card{\lambda} - \card{\mu}}} 2^{\card{\lambda}+\card{\mu}} \abs{f_\lambda}^2 \\
							&\leq C\sum_{\lambda \in \Lambda} 2^{\card{\lambda}} \abs{f_\lambda}^2 \sum_{\mu \in \Lambda} 2^{-(d+1)\abs{\card{\lambda}-\card{\mu}}}2^\mu \\
							&\leq C\sum_{\lambda \in \Lambda}  2^{\card{\lambda}} \abs{f_\lambda}^2 \Bigg( \underbrace{\sum_{0\leq\mu\leq\lambda} 2^{-(d+1)(\lambda - \mu)}2^{\mu}}_{term_1} \\
							&\qquad  + \underbrace{\sum_{\mu > \lambda} 2^{-(d+1)(\mu-\lambda)}2^{\mu} }_{term_2} \Bigg) \label{eq:terms}
		\end{align*}
		Inspecting $term_1$ by factoring out the terms which are independent of the dummy variable $\mu$ we find
		\begin{align*}
			term_1 &= 2^{-(d+1) \lambda }\sum_{0\leq\mu\leq\lambda} 2^{(d+2) \mu} \\
			&= 2^{-(d+1) \lambda} \left(  \frac{ 1-2^{(d+2)(\lambda + 1)} }{1 - 2^{d+2} } \right) \\
			&\leq 2^{-(d+1) \lambda} 2^{2(d+2)\lambda}.
		\end{align*}
		By the same tactic we find $term_2 \leq 2^{\lambda - d}$.  Substituting these expressions into our original calculation we find
		\begin{align*}	
			\norm{[X]f}_{l^2}^2 	&\leq C(2^{(d+2)}+2^{-d}) \sum_{\lambda \in \Lambda} 2^{2\lambda} \abs{f_{\lambda}}^2 \\
							&\leq C(2^{(d+2)}+2^{-d}).
		\end{align*}
\end{proof}

\begin{lemma} 
	Let $[X]^{(j)}=([X]^{(j)}_{\lambda,\mu})_{\lambda,\mu \in \Lambda}$ be such that $m^{(j)}_{\lambda,\mu} = m_{\lambda,\mu}$ if $\card{\lambda}$ and $\card{\mu}$ are both less than or equal to $j$ and $0$ otherwise. Then there exists a $C > 0$ such that for all $f \in W^{s,2}$:
	\begin{equation}
		\norm{( [X]- [X]^{(j)})(P_j f)}_{l^2} \leq C2^{-(d/2)(j+1)} \norm{f}_{W^{s,2}}.
	\end{equation}
\end{lemma}
\begin{proof}
	\begin{align*}
		\norm{([X]-[X]^{(j)})(P_j f)}_{\ell^2}^2 &= \sum_{\lambda \in \Lambda} \sum_{\card{\mu}\leq j} \abs{[X]_{\lambda,\mu}-[X]^{(j)}_{\lambda,\mu}}^2 \abs{(P_j f)_\mu}^2 \\
	\intertext{by the definitions of $[X]^{(j)} = \{ [X]_{\lambda,\mu}^{(j)} \}$ }
		\qquad &= \sum_{\card{\mu}\leq j}\abs{(P_j f)_\mu}^2 \sum_{\card{\lambda}>j}\abs{[X]_{\lambda,\mu}}^2 \\
	\intertext{by Lemma \ref{lem:M_bound}}
		 \leq& C'\sum_{\card{\mu}\leq j}\abs{(P_j f)_\mu}^2 2^{(d+2)\card{\mu}}\sum_{\card{\lambda}>j}2^{-d\card{\lambda}} \\
		 \leq& C' 2^{-2(\frac{d}{2})(j+1)}\norm{P_j f}^2_{\ell^2_{d/2+1}}
	\end{align*}
	The result follows by Remark 3.3.1 in \cite{Cohen2003}.
\end{proof}

\begin{corollary}
	The difference between $[X]^j (P_j f)$ and $[X] f$ is bounded by
	\[
		\norm{[X]f - [X]^{(j)}(P_j f)}_{\ell^2} \leq C \left( 2^{-sj}\norm{f}_{W^{s,2}} + 2^{-\frac{d}{2}(j+1)}\norm{f}_{W^{s,2}} \right).
	\]
\end{corollary}
\begin{proof}
	Follows from the triangle inequality:
	\begin{align*}
		&\norm{[X]f - [X] P_j f + [X] P_j f - [X]^{(j)} P_j f}_{\ell^2} \leq \\
		&\qquad \norm{M}_{\ell^2} \norm{f - P_j f}_{\ell^2} + \norm{([X]-[X]^{(j)})(P_j f)}_{\ell^2}.
	\end{align*}
\end{proof}

\ram{The only weird thing here is that we use the $L^2$--norm on both the domain and the range, but we only have the rate of convergence for points in the domain that are $W^{s,2}$.}

Next we will construct an error bound for the collocation approximation of the exponential map.

\begin{lemma}
Let $A$ and $B$ be anti-Hermetian operators on a Hilbert space.  Let $x(t)$ satisfy $\dot{x} = Ax$ and $y(t)$ satisfy $\dot{y} = By$.  If $x(0) = y(0)$ and $\| A - B \| < \varepsilon$, then $u(t) = \| x(t) - y(t) \|$ satisfies $u(t) < \varepsilon t  \| y(0) \|$.
\end{lemma}

\begin{proof}
	We calculate
	\begin{align*}
		\frac{du}{dt} &= \frac{1}{2u(t)} \langle Ax(t) - By(t) , x(t) - y(t) \rangle \\
			&= \frac{1}{2u} \langle A(x(t)-y(t)) + (A-B) y(t) , x(t) - y(t) \rangle \\
			&= \frac{1}{2u} \langle (A-B)y(t) , x(t) - y(t) \rangle \\
			&\leq \frac{1}{2u(t)} \| A - B \| \cdot \| y(t) \| \cdot \| x(t) - y(t) \| \\
			&< \varepsilon \| y(t) \|
	\end{align*}
	However $\| y(0) \| = \| y(t)\|$ because the $B$ is anti-Hermetian.  Thus $\frac{du}{dt} < \varepsilon \| y(0)\|$.	The result follows by integration.
\end{proof}
As $[X]$ and $[X]^{(j)}$ are anti-Hermetian operators, the upshot of this Lemma is that the deviation of the time $t$ flow of $\dot{f} = [X]^{(j)} f$ from that of $\dot{f} = [X] f$ is bounded by a quantity proportional to
\[
 	t \left( 2^{-sj}\norm{f(0)}_{W^{s,2}} + 2^{-\frac{d}{2}(j+1)}\norm{f(0)}_{W^{s,2}} \right) \| f (0) \|_{\mathcal{H}}
\]
